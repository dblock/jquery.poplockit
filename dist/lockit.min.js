/*! Lockit - v0.1.0 - 2012-12-31
* https://github.com/zamiang/lockit-js
* Copyright (c) 2012 Brennan Moore; Licensed MIT */
(function(){var e,t,n,r,i=function(e,t){return function(){return e.apply(t,arguments)}};e=jQuery,t=function(){function e(e,t){this.$el=e,this.settings=t,this.originalWidth=this.width=this.$el.outerWidth(!1),this.originalHeight=this.height=this.$el.height()}return e.prototype.setPosition=function(e,t){var n;return e==null&&(e="absolute"),t==null&&(t="north"),n={position:e,top:t==="north"?this.defaultTop:"auto",bottom:t==="south"?this.defaultBottom:"auto"},this.$el.css(n)},e.prototype.onScroll=function(e,t){if(t>=this.model.get("height"))return;if(e>=this.model.get("top")&&e<this.model.get("bottom"))return this.setPosition("fixed");if(e<this.model.get("top"))return this.setPosition("absolute","north");if(e>=this.model.get("bottom"))return this.setPosition("absolute","south")},e}(),n=function(){function e(){this.onResize=i(this.onResize,this),this.onScroll=i(this.onScroll,this)}return e.prototype.active=!0,e.prototype.rendered=!1,e.prototype.onScroll=function(){var e,t,n,r,i;if(!this.active)return;t=this.$win.scrollTop();if(t===this.previousScrollTop)return window.requestAnimationFrame(this.onScroll);this.scrollingDown=this.previousScrollTop<t,i=this.items;for(n=0,r=i.length;n<r;n++)e=i[n],e.onScroll(t,this.height);return this.previousScrollTop=t,window.requestAnimationFrame(this.onScroll)},e.prototype.recomputeEachLiHeight=function(){var e,t,n,r,i;r=this.items,i=[];for(t=0,n=r.length;t<n;t++)e=r[t],i.push(e.setWayPointThrottled());return i},e.prototype.repositionEachLi=function(){var e,t,n,r,i;r=this.items,i=[];for(t=0,n=r.length;t<n;t++)e=r[t],i.push(e.onScroll(this.previousScrollTop,this.$win.height()));return i},e.prototype.onResize=function(){var e,t,n,r;this.setMaxWidth(),r=this.items;for(t=0,n=r.length;t<n;t++)e=r[t],e.onResize(),e.onScroll(this.previousScrollTop,this.$win.height());return this.height=this.$win.outerHeight(!0)},e.prototype.setMaxWidth=function(){return this.$(".max_width").length>0||this.$el.append("<div class='max_width'></div>"),this.maxWidth=Number(this.$el.find(".max_width").css("max-width").replace("px",""))},e.prototype.bindWindowEvents=function(){this.requestAnimationFrame(this.onScroll);if(!App.IS_IOS)return this.$win.bind("resize.feedItem",this.debounce(this.onResize,100))},e.prototype.unbindWindowEvents=function(){return this.$win.unbind(".feedItem")},e.prototype.debounce=function(e,t){var n;return n=0,function(){var r,i,s=this;return r=arguments,i=function(){return n=null,e(r)},clearTimeout(n),n=setTimeout(i,t)}},e.prototype.initRequestAnimationFrame=function(){var e,t,n,r,i;if(window.requestAnimationFrame){this.requestAnimationFrame=window.requestAnimationFrame,this.cancelAnimationFrame=window.cancelAnimationFrame;return}e=0,n=["ms","moz","webkit","o"];for(r=0,i=n.length;r<i;r++){t=n[r];if(!!this.requestAnimationFrame)continue;this.requestAnimationFrame=window[""+t+"RequestAnimationFrame"],this.cancelAnimationFrame=window[""+t+"CancelAnimationFrame"]||window[""+t+"CancelAnimationFrame"]}this.requestAnimationFrame||(this.requestAnimationFrame=function(t,n){var r,i,s;return r=(new Date).getTime(),s=Math.max(0,16-(r-e)),i=window.setTimeout(function(){return t(r+s)},s),e=r+s,i});if(!this.cancelAnimationFrame)return this.cancelAnimationFrame=function(e){return clearTimeout(e)}},e}(),r={initialize:function(e){return this.settings=e,this},destroy:function(){return e(window).unbind("resize.lockit")}},e.fn.lockit=function(t){return r[t]!=null?r[t].apply(this,Array.prototype.slice.call(arguments,1)):typeof t=="object"||t==null?r.initialize.apply(this,arguments):e.error("Method "+t+" does not exist on jQuery.lockit")}}).call(this);