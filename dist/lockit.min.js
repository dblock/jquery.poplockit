/*! Lockit - v0.1.0 - 2012-12-31
* https://github.com/zamiang/lockit-js
* Copyright (c) 2012 Brennan Moore; Licensed MIT */
(function(){var e,t,n,r,i=function(e,t){return function(){return e.apply(t,arguments)}};e=jQuery,t=function(){function e(e,t){var n,r,i,s;s=this.requires;for(r=0,i=s.length;r<i;r++){n=s[r];if(t[n]==null)throw"You must pass "+n}this.$el=e,this.settings=t,this.setDimensions()}return e.prototype.requires=["height","margin","defaultTop","defaultbottom"],e.prototype.setDimensions=function(e){return e&&(this.settings.height=e),this.top=this.$el.offset().top,this.bottom=top+this.settings.height-this.$el.outerHeight(!0)-this.settings.margin*2},e.prototype.setPosition=function(e,t){return e==null&&(e="absolute"),t==null&&(t="north"),this.$el.css({position:e,top:t==="north"?this.settings.defaultTop:"auto",bottom:t==="south"?this.settings.defaultBottom:"auto"})},e.prototype.onScroll=function(e,t){if(t>=this.height)return;if(e>=this.top&&e<this.bottom)return this.setPosition("fixed");if(e<this.top)return this.setPosition("absolute","north");if(e>=this.bottom)return this.setPosition("absolute","south")},e}(),n=function(){function t(t){this.onScroll=i(this.onScroll,this);var n,r,s,o,u,a;u=this.requires;for(s=0,o=u.length;s<o;s++){r=u[s];if(t[r]==null)throw"You must pass "+r}this.detectiOS(),this.initRequestAnimationFrame(),this.settings=e.extend(this.defaults,t),n=(a=this.$el)!=null?a.find("> li"):void 0,n&&(this.items=n.map(function(){return new Li(e(this),this.settings)}))}return t.prototype.defaults={defaultTop:"90px",defaultBottom:"90px",margin:90,active:!0,rendered:!1},t.prototype.requires=[],t.prototype.onScroll=function(){var e,t,n,r,i;if(!this.active)return;t=this.$win.scrollTop();if(t===this.previousScrollTop)return this.requestAnimationFrame(this.onScroll);this.scrollingDown=this.previousScrollTop<t,i=this.items;for(n=0,r=i.length;n<r;n++)e=i[n],e.onScroll(t,this.height);return this.previousScrollTop=t,this.requestAnimationFrame(this.onScroll)},t.prototype.recomputeEachLiHeight=function(){var e,t,n,r,i;r=this.items,i=[];for(t=0,n=r.length;t<n;t++)e=r[t],i.push(e.setWayPointThrottled());return i},t.prototype.repositionEachLi=function(){var e,t,n,r,i;r=this.items,i=[];for(t=0,n=r.length;t<n;t++)e=r[t],i.push(e.onScroll(this.previousScrollTop,this.$win.height()));return i},t.prototype.onResize=function(){var e,t,n,r;this.setMaxWidth(),r=this.items;for(t=0,n=r.length;t<n;t++)e=r[t],e.onResize(),e.onScroll(this.previousScrollTop,this.$win.height());return this.height=this.$win.outerHeight(!0)},t.prototype.bindWindowEvents=function(){this.requestAnimationFrame(this.onScroll);if(!this.IS_IOS)return this.$win.bind("resize.feedItem",this.debounce(this.onResize,100))},t.prototype.unbindWindowEvents=function(){return this.$win.unbind(".feedItem")},t.prototype.destroy=function(){var e,t,n,r,i;this.settings.rendered=!1,this.setttings.active=!1,r=this.items,i=[];for(t=0,n=r.length;t<n;t++)e=r[t],i.push(this.item.destroy());return i},t.prototype.debounce=function(e,t){var n;return n=0,function(){var r,i,s=this;return r=arguments,i=function(){return n=null,e(r)},clearTimeout(n),n=setTimeout(i,t)}},t.prototype.detectiOS=function(){var e;return e=navigator.userAgent.toLowerCase(),this.IS_IOS=e.match(/(iPhone|iPod|iPad)/i)!=null},t.prototype.initRequestAnimationFrame=function(){var e,t,n,r,i;if(window.requestAnimationFrame){this.requestAnimationFrame=window.requestAnimationFrame,this.cancelAnimationFrame=window.cancelAnimationFrame;return}e=0,n=["ms","moz","webkit","o"];for(r=0,i=n.length;r<i;r++){t=n[r];if(!!this.requestAnimationFrame)continue;this.requestAnimationFrame=window[""+t+"RequestAnimationFrame"],this.cancelAnimationFrame=window[""+t+"CancelAnimationFrame"]||window[""+t+"CancelAnimationFrame"]}this.requestAnimationFrame||(this.requestAnimationFrame=function(t,n){var r,i,s;return r=(new Date).getTime(),s=Math.max(0,16-(r-e)),i=window.setTimeout(function(){return t(r+s)},s),e=r+s,i});if(!this.cancelAnimationFrame)return this.cancelAnimationFrame=function(e){return clearTimeout(e)}},t}(),r={initialize:function(e){if(e==null)throw"You must pass settings";return this.ul=new n(e),this},destroy:function(){return e(window).unbind("resize.lockit"),this.ul.destroy()}},e.fn.lockit=function(t){return r[t]!=null?r[t].apply(this,Array.prototype.slice.call(arguments,1)):typeof t=="object"||t==null?r.initialize.apply(this,arguments):e.error("Method "+t+" does not exist on jQuery.lockit")}}).call(this);